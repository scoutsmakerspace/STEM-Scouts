---
layout: single
toc: true
---

{% assign a = page %}

{%- comment -%}
  Build a "fake" HTML document containing only headings that match our section anchors.
  Then feed that into Minimal Mistakes' toc.html include so it looks like the theme TOC,
  even though the real headings live in the layout (not in {{ content }}).
{%- endcomment -%}

{% capture toc_source %}
<div class="activity-toc-source">
  {% if a.kit_list %}<h2><a href="#kit">You will need</a></h2>{% endif %}
  {% if a.learning_goals and a.learning_goals.size > 0 %}<h2><a href="#goals">Learning goals</a></h2>{% endif %}
  {% if a.leader and a.leader.prep %}<h2><a href="#prep">Leader prep</a></h2>{% endif %}
  {% if a.leader and a.leader.briefing %}<h2><a href="#briefing">Leader briefing</a></h2>{% endif %}
  {% if a.leader and a.leader.safety_brief %}<h2><a href="#safety">Safety briefing</a></h2>{% endif %}
  {% if a.running and a.running.steps %}<h2><a href="#steps">How to run</a></h2>{% endif %}
  {% if a.running and a.running.differentiation %}<h2><a href="#diff">Make it easier / harder</a></h2>{% endif %}
  {% if a.running and a.running.time_plan and a.running.time_plan.size > 0 %}<h2><a href="#time">Time plan</a></h2>{% endif %}
  {% if a.running and a.running.reflection %}<h2><a href="#reflection">Reflection</a></h2>{% endif %}
  {% if a.resources and a.resources.documents and a.resources.documents.size > 0 %}<h2><a href="#downloads">Downloads</a></h2>{% endif %}
  {% if a.resources and a.resources.external_docs and a.resources.external_docs.size > 0 %}<h2><a href="#links">External tutorials</a></h2>{% endif %}
  {% if a.badges and a.badges.size > 0 %}<h2><a href="#badges">Badge links</a></h2>{% endif %}
  {% if content and content != "" %}<h2><a href="#extra">Extra notes</a></h2>{% endif %}
</div>
{% endcapture %}

{% assign has_any_toc =
  a.kit_list
  or (a.learning_goals and a.learning_goals.size > 0)
  or (a.leader and a.leader.prep)
  or (a.leader and a.leader.briefing)
  or (a.leader and a.leader.safety_brief)
  or (a.running and a.running.steps)
  or (a.running and a.running.differentiation)
  or (a.running and a.running.time_plan and a.running.time_plan.size > 0)
  or (a.running and a.running.reflection)
  or (a.resources and a.resources.documents and a.resources.documents.size > 0)
  or (a.resources and a.resources.external_docs and a.resources.external_docs.size > 0)
  or (a.badges and a.badges.size > 0)
  or (content and content != "")
%}

{% if has_any_toc %}
<section class="activity-card" id="toc">
  <h3 class="activity-card__title">On this page</h3>
  {% include toc.html html=toc_source sanitize=true %}
</section>
{% endif %}

{% if a.hero_image %}
  <figure class="activity-hero" style="margin: 0 0 1rem 0;">
    <img src="{{ a.hero_image | relative_url }}" alt="{{ a.title | escape }}" style="width:100%; border-radius:12px;">
  </figure>
{% endif %}

<section class="activity-card">
  <h3 class="activity-card__title">At a glance</h3>

  {% if a.summary %}
    <p class="activity-muted" style="margin-top:-.25rem;">{{ a.summary }}</p>
  {% endif %}

  <ul class="activity-glance">
    {% if a.sections %}
      <li><strong>Sections:</strong>
        {% for s in a.sections %}
          {{ s | downcase | capitalize }}{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </li>
    {% endif %}
    {% if a.difficulty %}<li><strong>Difficulty:</strong> {{ a.difficulty }}/5</li>{% endif %}
    {% if a.time_minutes %}<li><strong>Time:</strong> {{ a.time_minutes }} min</li>{% endif %}
    {% if a.supervision %}<li><strong>Supervision:</strong> {{ a.supervision }}</li>{% endif %}
    {% if a.location %}<li><strong>Location:</strong> {{ a.location }}</li>{% endif %}
    {% if a.type %}<li><strong>Type:</strong> {{ a.type }}</li>{% endif %}
    {% if a.group_size %}<li><strong>Group size:</strong> {{ a.group_size }}</li>{% endif %}
    {% if a.setup_notes %}<li><strong>Setup notes:</strong> {{ a.setup_notes }}</li>{% endif %}
  </ul>

  <div class="activity-ra" style="margin-top:.5rem;">
    <strong>Risk assessment:</strong>
    {% assign match = nil %}

    {% if a.resources and a.resources.risk_assessment %}
      {% for ra in site.risk_assessments %}
        {% if ra.slug == a.resources.risk_assessment %}
          {% assign match = ra %}
          {% break %}
        {% endif %}
      {% endfor %}
    {% endif %}

    {% if match %}
      <a href="{{ match.url | relative_url }}">{{ match.title }}</a>
      <p class="activity-warning" style="margin-top:.5rem;">
        This is an example Risk Assessment. Leaders must review and create their own version for their activity.
      </p>
    {% else %}
      <span class="activity-warning" style="margin-top:.5rem; display:inline-block;">
        No Risk Assessment linked yet — create and link one before running this activity.
      </span>
    {% endif %}
  </div>
</section>

{% if a.kit_list %}
<section class="activity-card" id="kit">
  <h3 class="activity-card__title">You will need</h3>
  {{ a.kit_list | markdownify }}
</section>
{% endif %}

{% if a.learning_goals and a.learning_goals.size > 0 %}
<section class="activity-card" id="goals">
  <h3 class="activity-card__title">Learning goals</h3>
  <ul>
    {% for g in a.learning_goals %}
      <li>{% if g.goal %}{{ g.goal }}{% else %}{{ g }}{% endif %}</li>
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if a.leader and a.leader.prep %}
<section class="activity-card" id="prep">
  <h3 class="activity-card__title">Leader prep (before the meeting)</h3>
  {{ a.leader.prep | markdownify }}
</section>
{% endif %}

{% if a.leader and a.leader.briefing %}
<section class="activity-card" id="briefing">
  <h3 class="activity-card__title">Leader briefing (what to explain first)</h3>
  {{ a.leader.briefing | markdownify }}
</section>
{% endif %}

{% if a.leader and a.leader.safety_brief %}
<section class="activity-card" id="safety">
  <h3 class="activity-card__title">Safety briefing (key points)</h3>
  {{ a.leader.safety_brief | markdownify }}
</section>
{% endif %}

{% if a.running and a.running.steps %}
<section class="activity-card" id="steps">
  <h3 class="activity-card__title">How to run the activity</h3>
  <div class="activity-steps">
    {{ a.running.steps | markdownify }}
  </div>
</section>
{% endif %}

{% if a.running and a.running.differentiation %}
<section class="activity-card" id="diff">
  <h3 class="activity-card__title">Make it easier / harder</h3>
  {{ a.running.differentiation | markdownify }}
</section>
{% endif %}

{% if a.running and a.running.time_plan and a.running.time_plan.size > 0 %}
<section class="activity-card" id="time">
  <h3 class="activity-card__title">Time plan</h3>
  <ul>
    {% for t in a.running.time_plan %}
      <li>
        <strong>{{ t.label }}:</strong> {{ t.minutes }} min
        {% if t.notes %} — {{ t.notes }}{% endif %}
      </li>
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if a.running and a.running.reflection %}
<section class="activity-card" id="reflection">
  <h3 class="activity-card__title">Reflection / questions</h3>
  {{ a.running.reflection | markdownify }}
</section>
{% endif %}

{% if a.resources and a.resources.documents and a.resources.documents.size > 0 %}
<section class="activity-card" id="downloads">
  <h3 class="activity-card__title">Downloads</h3>
  <ul>
    {% for doc in a.resources.documents %}
      {% if doc.file %}
        <li>
          <a href="{{ doc.file | relative_url }}"
             target="_blank" rel="noopener noreferrer"
             data-external="true">
            {{ doc.title }}
          </a>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if a.resources and a.resources.external_docs and a.resources.external_docs.size > 0 %}
<section class="activity-card" id="links">
  <h3 class="activity-card__title">External tutorials</h3>
  <ul>
    {% for d in a.resources.external_docs %}
      {% if d.url %}
        <li>
          <a href="{{ d.url }}"
             target="_blank" rel="noopener noreferrer"
             data-external="true">
            {{ d.title }}
          </a>
        </li>
      {% endif %}
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if a.badges and a.badges.size > 0 %}
<section class="activity-card" id="badges">
  <h3 class="activity-card__title">Badge links (reference)</h3>
  <ul>
    {% for b in a.badges %}
      <li>
        <strong>{{ b.section | downcase | capitalize }}:</strong> {{ b.badge }}
        {% if b.requirement_ref %} — {{ b.requirement_ref }}{% endif %}
        {% if b.url %}
          (<a href="{{ b.url }}" target="_blank" rel="noopener noreferrer" data-external="true">official link</a>)
        {% endif %}
      </li>
    {% endfor %}
  </ul>
</section>
{% endif %}

{% if content and content != "" %}
<section class="activity-card" id="extra">
  <h3 class="activity-card__title">Extra notes</h3>
  {{ content }}
</section>
{% endif %}

<script>
  (function(){
    // Only force new-tab for external links.
    // Skip internal anchors (#...), and skip site-relative links (/...).
    document.querySelectorAll('.page__content a[href]').forEach(function(a){
      var href = a.getAttribute('href') || '';
      if (!href) return;
      if (href.startsWith('#')) return;
      if (href.startsWith('/')) return;
      // already marked as external or absolute URL
      if (a.dataset && a.dataset.external === 'true') return;
      if (href.startsWith('http://') || href.startsWith('https://')) {
        a.setAttribute('target','_blank');
        a.setAttribute('rel','noopener noreferrer');
      }
    });
  })();
</script>
